# University Programs

## DevOps education program
### Module 5 Linux Essentials

#### TASK 1

##### Part1

1. How many states could has a process in Linux?

* Running or Runnable
* Sleeping or Waiting
* Stopped
* Zombie


From ```ps```

PROCESS STATE CODES
       Here are the different values that the s, stat and state output specifiers (header "STAT"
       or "S") will display to describe the state of a process:

               D    uninterruptible sleep (usually IO)
               I    Idle kernel thread
               R    running or runnable (on run queue)
               S    interruptible sleep (waiting for an event to complete) (non-active <20s)
               T    stopped by job control signal
               t    stopped by debugger during the tracing
               W    paging (not valid since the 2.6.xx kernel)
               X    dead (should never be seen)
               Z    defunct ("zombie") process, terminated but not reaped by its parent


Complete life cycle of process can be circle as â€“

Spawn->Waiting->Runnable->Running->Stopped->Zombie->Removed from process table

2. Examine the pstree command. Make output (highlight) the chain (ancestors) of the current
process.
```sh

[root@localhost ~]# pstree
systemd-T-NetworkManager---2*[{NetworkManager}]
        +-VGAuthService
        +-agetty
        +-atd
        +-auditd-T-sedispatch
        Â¦        L-2*[{auditd}]
        +-crond
        +-dbus-daemon---{dbus-daemon}
        +-java---32*[{java}]
        +-lsmd
        +-mcelog
        +-polkitd---5*[{polkitd}]
        +-rhsmcertd
        +-rngd---{rngd}
        +-rsyslogd---2*[{rsyslogd}]
        +-smartd
        +-sshd-T-sshd---sshd---bash---pstree
        Â¦      L-sshd---sshd---sftp-server
        +-sssd-T-sssd_be
        Â¦      L-sssd_nss
        +-systemd---(sd-pam)
        +-systemd-journal
        +-systemd-logind
        +-systemd-udevd
        +-tuned---3*[{tuned}]
        L-vmtoolsd---2*[{vmtoolsd}]
```
**+-sshd--sshd---sshd---bash---pstree**

3. What is a proc file system?
```/proc``` directory is pseudo-filesystem in which the kernel exposes a variety of interesting information about the systemâ€™s state.
```/proc``` is containing a variety of status information and statistics generated by
the kernel.

4. Print information about the processor (its type, supported technologies, etc.).

```lscpu```

```sh
Architecture:        x86_64
CPU op-mode(s):      32-bit, 64-bit
Byte Order:          Little Endian
CPU(s):              1
On-line CPU(s) list: 0
Thread(s) per core:  1
Core(s) per socket:  1
Socket(s):           1
NUMA node(s):        1
Vendor ID:           GenuineIntel
CPU family:          6
Model:               42
Model name:          Intel(R) Core(TM) i5-2430M CPU @ 2.40GHz
Stepping:            7
CPU MHz:             2394.559
BogoMIPS:            4789.11
Hypervisor vendor:   VMware
Virtualization type: full
L1d cache:           32K
L1i cache:           32K
L2 cache:            256K
L3 cache:            3072K
NUMA node0 CPU(s):   0
Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc arch_perfmon nopl xtopology tsc_reliable nonstop_tsc cpuid pni pclmulqdq ssse3 cx16 pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx hypervisor lahf_lm pti tsc_adjust arat
```
**or**

```cat /proc/cpuinfo```

```sh
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 42
model name      : Intel(R) Core(TM) i5-2430M CPU @ 2.40GHz
stepping        : 7
microcode       : 0x28
cpu MHz         : 2394.559
cache size      : 3072 KB
physical id     : 0
siblings        : 1
core id         : 0
cpu cores       : 1
apicid          : 0
initial apicid  : 0
fpu             : yes
fpu_exception   : yes
cpuid level     : 13
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 syscall nx rdtscp lm constant_tsc arch_perfmon nopl xtopology tsc_reliable nonstop_tsc cpuid pni pclmulqdq ssse3 cx16 pcid sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx hypervisor lahf_lm pti tsc_adjust arat
bugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs itlb_multihit
bogomips        : 4789.11
clflush size    : 64
cache_alignment : 64
address sizes   : 43 bits physical, 48 bits virtual
power management:
```

5. Use the ps command to get information about the process. The information should be as
follows: the owner of the process, the arguments with which the process was launched for
execution, the group owner of this process, etc.

```ps axjfg```

       a      Lift the BSD-style "only yourself" restriction, which is imposed upon the set of all processes when some BSD-style
              (without "-") options are used or when the ps personality setting is BSD-like.  The set of processes selected in this
              manner is in addition to the set of processes selected by other means.  An alternate description is that this option
              causes ps to list all processes with a terminal (tty), or to list all processes when used together with the x option.


       x      An alternate description is that this option causes ps to list all processes owned by you (same EUID as ps), or to list all processes when used together with the a
              option.
	   j      BSD job control format.
       f     Do full-format listing. This option can be combined with many other UNIX-style options to add additional columns.  It
              also causes the command arguments to be printed.  When used with -L, the NLWP (number of threads) and LWP (thread ID)
              columns will be added.  See the c option, the format keyword args, and the format keyword comm.
	   g      Really all, even session leaders.  This flag is obsolete and may be discontinued in a future release.		

*AIX FORMAT DESCRIPTORS
```ps -eo "%p %y %x %c"```
```sh
       CODE   NORMAL   HEADER
       %C     pcpu     %CPU
       %G     group    GROUP
       %P     ppid     PPID
       %U     user     USER
       %a     args     COMMAND
       %c     comm     COMMAND
       %g     rgroup   RGROUP
       %n     nice     NI
       %p     pid      PID
       %r     pgid     PGID
       %t     etime    ELAPSED
       %u     ruser    RUSER
       %x     time     TIME
       %y     tty      TTY
       %z     vsz      VSZ
```
*STANDARD FORMAT SPECIFIERS

```ps -A -o %cpu,pid,ppid,gid,args,comm```

```sh
%CPU     PID    PPID   GID COMMAND                     COMMAND
 0.2       1       0     0 /usr/lib/systemd/systemd -- systemd
 0.0       2       0     0 [kthreadd]                  kthreadd
 0.0       3       2     0 [rcu_gp]                    rcu_gp
 0.0       4       2     0 [rcu_par_gp]                rcu_par_gp
 0.0       6       2     0 [kworker/0:0H-kblockd]      kworker/0:0H-kblockd
 0.0       7       2     0 [kworker/u256:0-flush-253:1 kworker/u256:0-flush-253:1
 0.0       8       2     0 [mm_percpu_wq]              mm_percpu_wq
 0.0       9       2     0 [ksoftirqd/0]               ksoftirqd/0
 0.0      10       2     0 [rcu_sched]                 rcu_sched
 0.0      11       2     0 [migration/0]               migration/0
 0.0      12       2     0 [watchdog/0]                watchdog/0
 0.0      13       2     0 [cpuhp/0]                   cpuhp/0
 0.0      15       2     0 [kdevtmpfs]                 kdevtmpfs
 0.0      16       2     0 [netns]                     netns
 0.0      17       2     0 [kauditd]                   kauditd
 0.0      18       2     0 [khungtaskd]                khungtaskd
 0.0      19       2     0 [oom_reaper]                oom_reaper
 0.0      20       2     0 [writeback]                 writeback
 0.0      21       2     0 [kcompactd0]                kcompactd0
 0.0      22       2     0 [ksmd]                      ksmd
 0.0      23       2     0 [khugepaged]                khugepaged
 0.0      24       2     0 [crypto]                    crypto
 0.0      25       2     0 [kintegrityd]               kintegrityd
 0.0      26       2     0 [kblockd]                   kblockd
 0.0      27       2     0 [blkcg_punt_bio]            blkcg_punt_bio
 0.0      28       2     0 [tpm_dev_wq]                tpm_dev_wq
 0.0      29       2     0 [md]                        md
 0.0      30       2     0 [edac-poller]               edac-poller
 0.0      31       2     0 [watchdogd]                 watchdogd
 0.0      33       2     0 [pm_wq]                     pm_wq
```

and others ```%cpu,%mem,args,blocked,bsdstart,bsdtime,c,caught,cgname,cgroup,class,cls,cmd,comm,command,cp,cputime,cputimes,drs,egid,egroup,eip,esp,etime,etimes,euid,euser,f,fgid,fgroup,flag,flags,fname,fuid,fuser,gid,group,ignored,ipcns,label,lstart,lsession,luid,lwp,lxc,machine,maj_flt,min_flt,mntns,netns,ni,nice,nlwp,numa,nwchan,ouid,pcpu,pending,pgid,pgrp,pid,pidns,pmem,policy,ppid,pri,psr,rgid,rgroup,rss,rssize,rsz,rtprio,ruid,ruser,s,sched,seat,sess,sgi_p,sgid,sgroup,sid,sig,sigcatch,sigignore,sigmask,size,slice,spid,stackp,start,start_time,stat,state,suid,supgid,supgrp,suser,svgid,svuid,sz,tgid,thcount,tid,time,times,tnameTTY,tpgid,trs,tty,ucomm,uid```

6. How to define kernel processes and user processes?

Kernel processes (or "kernel threads") are children of PID 2 (kthreadd), so i can use
```ps --ppid 2 -p 2 -o uname,pid,ppid,cmd,cls```

```ps -ef```
Command names in brackets are not really commands at all but rather kernel threads scheduled as processes.
So, i can define by username and [brackets]

7. Print the list of processes to the terminal. Briefly describe the statuses of the processes.
What condition are they in, or can they be arriving in?

```sh
[root@localhost ~]# ps -aux
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
root           1  0.0  0.7 179476 13772 ?        Ss   16:43   0:02 /usr/lib/systemd/systemd --switche
root           2  0.0  0.0      0     0 ?        S    16:43   0:00 [kthreadd]
root           3  0.0  0.0      0     0 ?        I<   16:43   0:00 [rcu_gp]
root           4  0.0  0.0      0     0 ?        I<   16:43   0:00 [rcu_par_gp]
root           6  0.0  0.0      0     0 ?        I<   16:43   0:00 [kworker/0:0H-kblockd]
root           8  0.0  0.0      0     0 ?        I<   16:43   0:00 [mm_percpu_wq]
root           9  0.0  0.0      0     0 ?        S    16:43   0:00 [ksoftirqd/0]
root          10  0.0  0.0      0     0 ?        R    16:43   0:00 [rcu_sched]
root          11  0.0  0.0      0     0 ?        S    16:43   0:00 [migration/0]
root          12  0.0  0.0      0     0 ?        S    16:43   0:00 [watchdog/0]
root          13  0.0  0.0      0     0 ?        S    16:43   0:00 [cpuhp/0]
root          15  0.0  0.0      0     0 ?        S    16:43   0:00 [kdevtmpfs]
root          16  0.0  0.0      0     0 ?        I<   16:43   0:00 [netns]
root          17  0.0  0.0      0     0 ?        S    16:43   0:00 [kauditd]
root          18  0.0  0.0      0     0 ?        S    16:43   0:00 [khungtaskd]
root          19  0.0  0.0      0     0 ?        S    16:43   0:00 [oom_reaper]
root          20  0.0  0.0      0     0 ?        I<   16:43   0:00 [writeback]
root          21  0.0  0.0      0     0 ?        S    16:43   0:00 [kcompactd0]
root          22  0.0  0.0      0     0 ?        SN   16:43   0:00 [ksmd]
root          23  0.0  0.0      0     0 ?        SN   16:43   0:00 [khugepaged]
```

```
  D    uninterruptible sleep (usually IO)
               I    Idle kernel thread
               R    running or runnable (on run queue)
               S    interruptible sleep (waiting for an event to complete)
               T    stopped by job control signal
               t    stopped by debugger during the tracing
               W    paging (not valid since the 2.6.xx kernel)
               X    dead (should never be seen)
               Z    defunct ("zombie") process, terminated but not reaped by its parent
			   
               <    high-priority (not nice to other users)
               N    low-priority (nice to other users)
               L    has pages locked into memory (for real-time and custom IO)
               s    is a session leader
               l    is multi-threaded (using CLONE_THREAD, like NPTL pthreads do)
               +    is in the foreground process group
```

I can to print processes with printf() and fork() functions but I'm not sure what you mean it.
This can be done using the C language like there [1](https://www.thegeekstuff.com/2012/05/c-fork-function/),[2](https://www.thegeekstuff.com/2012/03/c-process-control-functions/)

8. Display only the processes of a specific user.

```
[root@localhost ~]# ps U jenkins
    PID TTY      STAT   TIME COMMAND
   1386 ?        Ssl    0:33 /etc/alternatives/java -Dcom.sun.akuma.Daemon=daemonized -Djava.awt.headless=tru
[root@localhost ~]# ps -u jenkins
    PID TTY          TIME CMD
   1386 ?        00:00:33 java
```
9. What utilities can be used to analyze existing running tasks (by analyzing the help for the ps command)?
> pgrep(1), pstree(1), top(1), proc(5).

10. What information does top command display?

>DESCRIPTION

       The  top program provides a dynamic real-time view of a running system.  It can display system sum?
       mary information as well as a list of processes or threads currently being  managed  by  the  Linux
       kernel.  The types of system summary information shown and the types, order and size of information
       displayed for processes are all user configurable and that configuration  can  be  made  persistent
       across restarts.

       The  program  provides  a  limited interactive interface for process manipulation as well as a much
       more extensive interface for personal configuration  --  encompassing every aspect  of  its  opera?
       tion.  And while top is referred to throughout this document, you are free to name the program any?
       thing you wish.  That new name, possibly an alias, will then be reflected on top's display and used
       when reading and writing a configuration file.

> NOTE

```sh
           us, user    : time running un-niced user processes
           sy, system  : time running kernel processes
           ni, nice    : time running niced user processes
           id, idle    : time spent in the kernel idle handler
           wa, IO-wait : time waiting for I/O completion
           hi : time spent servicing hardware interrupts
           si : time spent servicing software interrupts
           st : time stolen from this vm by the hypervisor
		   
	LXC  --  Lxc Container Name
           The  name  of  the  lxc  container within which a task is running.  If a process is not running
           inside a container, a dash (`-') will be shown.

	NI  --  Nice Value
           The nice value of the task.  A negative nice value means higher priority,  whereas  a  positive
           nice value means lower priority.  Zero in this field simply means priority will not be adjusted
           in determining a task's dispatch-ability.
	PR  --  Priority
           The scheduling priority of the task.  If you see `rt' in this field, it means the task is  run?
           ning under real time scheduling priority.
		   
									 Private | Shared
                                 1           |          2
            Anonymous  . stack               |
                       . malloc()            |
                       . brk()/sbrk()        | . POSIX shm*
                       . mmap(PRIVATE, ANON) | . mmap(SHARED, ANON)
                      -----------------------+----------------------
                       . mmap(PRIVATE, fd)   | . mmap(SHARED, fd)
          File-backed  . pgms/shared libs    |
                                 3           |          4

       The following may help in interpreting process level memory values displayed  as  scalable  columns
       and discussed under topic `3a. DESCRIPTIONS of Fields'.

          %MEM - simply RES divided by total physical memory
          CODE - the `pgms' portion of quadrant 3
          DATA - the entire quadrant 1 portion of VIRT plus all
                 explicit mmap file-backed pages of quadrant 3
          RES  - anything occupying physical memory which, beginning with
                 Linux-4.5, is the sum of the following three fields:
                 RSan - quadrant 1 pages, which include any
                        former quadrant 3 pages if modified
                 RSfd - quadrant 3 and quadrant 4 pages
                 RSsh - quadrant 2 pages
          RSlk - subset of RES which cannot be swapped out (any quadrant)
          SHR  - subset of RES (excludes 1, includes all 2 & 4, some 3)
          SWAP - potentially any quadrant except 4
          USED - simply the sum of RES and SWAP
          VIRT - everything in-use and/or reserved (all quadrants) (VIRT  --  Virtual Memory Size (KiB))
		  
	S  --  Process Status
           The status of the task which can be one of:
               D = uninterruptible sleep
               I = idle
               R = running
               S = sleeping
               T = stopped by job control signal
               t = stopped by debugger during trace
               Z = zombie
```

12. Display the processes of the specific user using the top command.

```sh
[root@localhost ~]# top -u jenkins
top - 21:22:35 up  1:50,  1 user,  load average: 0.00, 0.00, 0.00
Tasks: 140 total,   3 running, 137 sleeping,   0 stopped,   0 zombie
%Cpu(s):  1.3 us,  1.3 sy,  0.0 ni, 96.3 id,  0.0 wa,  0.7 hi,  0.3 si,  0.0 st
MiB Mem :   1790.0 total,    847.5 free,    486.8 used,    455.7 buff/cache
MiB Swap:      0.0 total,      0.0 free,      0.0 used.   1144.3 avail Mem

    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND
   1386 jenkins   20   0 2504528 279272  28360 S   0.3  15.2   0:44.02 java
```

12. What interactive commands can be used to control the top command? Give a couple of
examples.

4a. Global-Commands
               <Ent/Sp> ?, =, 0,
               A, B, d, E, e, g, h, H, I, k, q, r, s, W, X, Y, Z
			   
			   <Enter> or <Space>  :Refresh-Display
			   ? | h  :Help
			   =  :Exit-Task-Limits
					*Removes restrictions on which tasks are shown.  This command will  reverse
              any  `i'  (idle  tasks) and `n' (max tasks) commands that might be active.
			  0  :Zero-Suppress toggle
			  A  :Alternate-Display-Mode toggle
				*ALTERNATE-DISPLAY Provisions and the  `g'  interactive
              command for insight into `current' windows and field groups.
			  B  :Bold-Disable/Enable toggle
			  d | s  :Change-Delay-Time-interval
			  E  :Extend-Memory-Scale in Summary Area
			  e  :Extend-Memory-Scale in Task Windows
			  g  :Choose-Another-Window/Field-Group
			  H  :Threads-mode toggle
			  I  :Irix/Solaris-Mode toggle
			  k  :Kill-a-task
			  q  :Quit
			  r  :Renice-a-Task
			  W  :Write-the-Configuration-File
			  X  :Extra-Fixed-Width
			  Y  :Inspect-Other-Output
					*Most of the keys used to navigate the Inspect feature are reflected in its
              header  prologue.
					key      function
                  =        alternate status-line, file or pipeline
                  /        find, equivalent to `L' locate
                  n        find next, equivalent to `&' locate next
                  <Space>  scroll down, equivalent to <PgDn>
                  b        scroll up, equivalent to <PgUp>
                  g        first line, equivalent to <Home>
                  G        last line, equivalent to <End>
			  Z  :Change-Color-Mapping

4b. Summary-Area-Commands
               C, l, t, m, 1, 2, 3
			   
			  C  :Show-scroll-coordinates toggle
			  l  :Load-Average/Uptime toggle
			  t  :Task/Cpu-States toggle
			  m  :Memory/Swap-Usage toggle
					*
					  This command serves as a 4-way toggle, cycling through these modes:
						  1. detailed percentages by memory type
						  2. abbreviated % used/total available + bar graph
						  3. abbreviated % used/total available + block graph
						  4. turn off memory display
			  1  :Single/Separate-Cpu-States toggle
			  2  :NUMA-Nodes/Cpu-Summary toggle
			  3  :Expand-NUMA-Node
			  
4c. Task-Area-Commands
               Appearance:  b, J, j, x, y, z
               Content:     c, f, F, o, O, S, u, U, V
               Size:        #, i, n
               Sorting:     <, >, f, F, R
			   
			   
			  J  :Justify-Numeric-Columns toggle
			  j  :Justify-Character-Columns toggle
			  b  :Bold/Reverse toggle
			  x  :Column-Highlight toggle
					*The sort field might not  be visible because:
					  1) there is insufficient Screen Width
					  2) the `f' interactive command turned it Off
			  y  :Row-Highlight toggle
			  z  :Color/Monochrome toggle
4d. Color-Mapping
               <Ret>, a, B, b, H, M, q, S, T, w, z, 0 - 7
5b. Commands-for-Windows
               -, _, =, +, A, a, g, G, w
5c. Scrolling-a-Window
               C, Up, Dn, Left, Right, PgUp, PgDn, Home, End
5d. Searching-in-a-Window
               L, &

> 1. Open top; 2. Press <Interactive_Command_KEY>; 3. Enter some details if necessary; 4. We're seeing very interesting results.

13. Sort the contents of the processes window using various parameters (for example, theamount of processor time taken up, etc.)

             <  :Move-Sort-Field-Left
                 Moves the sort column to the left unless the current sort field is  the
                 first field being displayed.

             >  :Move-Sort-Field-Right
                 Moves the sort column to the right unless the current sort field is the
                 last field being displayed.
			
             f | F  :Fields-Management
                 These  keys  display a separate screen where you can change which field
                 is used as the sort column, among other functions.  This can be a  con?
                 venient  way  to simply verify the current sort field, when running top
                 with column highlighting turned Off.

             R  :Reverse/Normal-Sort-Field toggle
                 Using this interactive command you can  alternate  between  high-to-low
                 and low-to-high sorts.

          For  compatibility, this top supports most of the former top sort keys.  Since
          this is primarily a service to former top users, these commands do not  appear
          on any help screen.
                command   sorted-field                  supported
                A         start time (non-display)      No
                M         %MEM                          Yes
                N         PID                           Yes
                P         %CPU                          Yes
                T         TIME+                         Yes

          Before  using any of the following sort provisions, top suggests that you tem?
          porarily turn on column highlighting using the `x' interactive command.   That
          will help ensure that the actual sort environment matches your intent.

14. Concept of priority, what commands are used to set priority?

> Priority is the level of importance of a task or other object over others for ownership of a resource.

The command ```nice`` is created process with set scheduling priority.
Whereas the ```renice``` command allows you to change and modify the scheduling priority of an already running process.

[How To Calculate PR or PRI Values](https://www.tecmint.com/set-linux-process-priority-using-nice-and-renice-commands/)
>Priority 0 and above requires elevation.

15. Can I change the priority of a process using the top command? If so, how?

Yes,You can.
In ```top```.
Renice by pressing `r`. You will be prompted for the Process ID (PID) of the process you wish to renice. The default PID is the first process (one consuming the most resources). Confirm with Enter. Set the new nice value from -20 (higher priority) to +19 (lower priority).

In ```htop```
Renice with F7/F8 (if you are inside Byobu temporary disable shortcuts with Shift + F12).

16. Examine the kill command. How to send with the kill command process control signal? Give an example of commonly used signals.

```sh
[root@localhost ~]# kill -l
 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP
 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1
11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM
16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP
21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ
26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR
31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3
38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8
43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13
48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12
53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7
58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2
63) SIGRTMAX-1  64) SIGRTMAX
```

# KIll
SGINT 2 - Interrupt Ctrl-C
SIGTERM 15 - termination signal, as for the kill utility
SIGKILL 9 - unconditional completion

```man 7 signal```

```sh
 First the signals described in the original POSIX.1-1990 standard.

   Signal     Value     Action   Comment
   ----------------------------------------------------------------------
   SIGHUP        1       Term    Hangup detected on controlling terminal
                                 or death of controlling process
   SIGINT        2       Term    Interrupt from keyboard Ctrl+C
   SIGQUIT       3       Core    Quit from keyboard
   SIGILL        4       Core    Illegal Instruction
   SIGABRT       6       Core    Abort signal from abort(3)
   SIGFPE        8       Core    Floating point exception
   SIGKILL       9       Term    Kill signal (unconditional completion)
   SIGSEGV      11       Core    Invalid memory reference
   SIGPIPE      13       Term    Broken pipe: write to pipe with no readers
   SIGALRM      14       Term    Timer signal from alarm(2)
   SIGTERM      15       Term    Termination signal (termination signal, as for the kill utility)
   SIGUSR1   30,10,16    Term    User-defined signal 1
   SIGUSR2   31,12,17    Term    User-defined signal 2
   SIGCHLD   20,17,18    Ign     Child stopped or terminated
   SIGCONT   19,18,25    Cont    Continue if stopped
   SIGSTOP   17,19,23    Stop    Stop process
   SIGTSTP   18,20,24    Stop    Stop typed at terminal
   SIGTTIN   21,21,26    Stop    Terminal input for background process
   SIGTTOU   22,22,27    Stop    Terminal output for background process
   The signals SIGKILL and SIGSTOP cannot be caught, blocked, or ignored.
   
	Signal       Value     Action   Comment
   --------------------------------------------------------------------
   SIGBUS      10,7,10     Core    Bus error (bad memory access)
   SIGPOLL                 Term    Pollable event (Sys V).
                                   Synonym for SIGIO
   SIGPROF     27,27,29    Term    Profiling timer expired
   SIGSYS      12,31,12    Core    Bad argument to routine (SVr4)
   SIGTRAP        5        Core    Trace/breakpoint trap
   SIGURG      16,23,21    Ign     Urgent condition on socket (4.2BSD)
   SIGVTALRM   26,26,28    Term    Virtual alarm clock (4.2BSD)
   SIGXCPU     24,24,30    Core    CPU time limit exceeded (4.2BSD)
   SIGXFSZ     25,25,31    Core    File size limit exceeded (4.2BSD)

	Signal       Value     Action   Comment
   --------------------------------------------------------------------
   SIGIOT         6        Core    IOT trap. A synonym for SIGABRT
   SIGEMT       7,-,7      Term
   SIGSTKFLT    -,16,-     Term    Stack fault on coprocessor (unused)
   SIGIO       23,29,22    Term    I/O now possible (4.2BSD)
   SIGCLD       -,-,18     Ign     A synonym for SIGCHLD
   SIGPWR      29,30,19    Term    Power failure (System V)
   SIGINFO      29,-,-             A synonym for SIGPWR
   SIGLOST      -,-,-      Term    File lock lost (unused)
   SIGWINCH    28,28,20    Ign     Window resize signal (4.3BSD, Sun)
   SIGUNUSED    -,31,-     Core    Synonymous with SIGSYS


| Name      | The code | Default action                | Description                                                 | A type       |
|-----------|----------|-------------------------------|-------------------------------------------------------------|--------------|
| SIGABRT   | 6        | Completion with a memory dump | Signal sent by function abort()                             | Control      |
| SIGALRM   | 14       | Completion                    | Timeout signal set alarm()                                  | Notification |
| SIGBUS    | 10       | Completion with a memory dump | Incorrect access to physical memory                         | An exception |
| SIGCHLD   | 18       | Ignored                       | Child process completed or stopped                          | Notification |
| SIGCONT   | 25       | Continue execution            | Continue execution of a previously stopped process          | Control      |
| SIGFPE    | 8        | Completion with a memory dump | Erroneous arithmetic operation                              | An exception |
| SIGHUP    | one      | Completion                    | Closing the terminal                                        | Notification |
| SEAL      | 4        | Completion with a memory dump | Invalid processor instruction                               | An exception |
| SIGINT    | 2        | Completion                    | Interrupt signal (Ctrl-C) from terminal                     | Control      |
| SIGKILL   | 9        | Completion                    | Unconditional completion                                    | Control      |
| SIGPIPE   | 13       | Completion                    | Writing to a broken connection (pipe, socket)               | Notification |
| SIGQUIT   | 3        | Completion with a memory dump | Signal "Quit" from the terminal (Ctrl- \)                   | Control      |
| SIGSEGV   | 11       | Completion with a memory dump | Memory access violation                                     | An exception |
| SIGSTOP   | 23       | Stopping the process          | Stopping a process                                          | Control      |
| SIGTERM   | 15       | Completion                    | Termination signal (default signal for the kill utility)    | Control      |
| SIGTSTP   | 20       | Stopping the process          | Stop signal from terminal (Ctrl-Z).                         | Control      |
| SIGTTIN   | 26       | Stopping the process          | Attempting to read from terminal by background process      | Control      |
| SIGTTOU   | 27       | Stopping the process          | Attempting to write to the terminal by a background process | Control      |
| SIGUSR1   | 16       | Completion                    | Custom signal # 1                                           | Custom       |
| SIGUSR2   | 17       | Completion                    | Custom signal # 2                                           | Custom       |
| SIGPOLL   | 22       | Completion                    | Event tracked poll()                                        | Notification |
| SIGPROF   | 29       | Completion                    | Profiling timer expired                                     | Debugging    |
| SIGSYS    | 12       | Completion with a memory dump | Invalid system call                                         | An exception |
| SIGTRAP   | 5        | Completion with a memory dump | Trap trap or breakpoint                                     | Debugging    |
| SIGURG    | 21       | Ignored                       | Timed data received on socket                               | Notification |
| SIGVTALRM | 28       | Completion                    | Expiration of the "virtual timer"                           | Notification |
| SIGXCPU   | 30       | Completion with a memory dump | The process has exceeded the processor time limit           | An exception |
| SIGXFSZ   | 31       | Completion with a memory dump | The process has exceeded the allowed file size              | An exception |
```

[SignalsIPC_PoSIX](https://en.wikipedia.org/wiki/Signal_(IPC))

You can do that with the ```pgrep``` command (there is also a ```pkill``` command, but this two-part method ensures that we are only killing the intended process). Use ```pgrep``` and the ```-a``` flag

17. Commands jobs, fg, bg, nohup. What are they for? Use the sleep, yes command to demonstrate the process control mechanism with fg, bg.

A job is a process that the shell manages. Each job is assigned a sequential job ID. Because a job is a process, each job has an associated PID. There are three types of job statuses:
1. Foreground: When you enter a command in a terminal window, the command occupies that terminal window until it completes. This is a foreground job.
2. Background: When you enter an ampersand (&) symbol at the end of a command line, the command runs without occupying the terminal window. The shell prompt is displayed immediately after you press Return. This is an example of a background job.
3. Stopped: If you press Control + Z for a foreground job, or enter the stop command for a background job, the job stops. This job is called a stopped job.

|     Option    	| Description                                                                                                    	|
|:-------------:	|----------------------------------------------------------------------------------------------------------------	|
| jobs          	| Lists all jobs                                                                                                 	|
| bg %n         	| Places the current or specified job in the background, where n is the job ID (return)                          	|
| fg %n         	| Brings the current or specified job into the foreground, where n is the job ID                                 	|
| Control-Z     	| Stops the foreground job and places it in the background as a stopped job                                      	|
| ampersand (&) 	| Symbol at the end of the command line, run the sleep command in the background                                 	|
| Control - C   	| Interrupt the process                                                                                          	|
| nohup         	| This makes the started process immune to the SIGHUP signal. It will continue running when the terminal closes. 	|
| disown        	| Removes a job from the jobs queue of a terminal                                                                	|



>Note: When you place a stopped job either in the foreground or background, the job restarts.

%n - where n is the job number
%abc - refers to a job started by a command beginning with abc
%?abc - refers to a job started by a command containing abc
%- - specifies the previous job

```nohup``` command makes the started process immune to the SIGHUP signal. It will continue running when the terminal closes. It will be reassigned as a child of the init system:

Using the ```huponexit``` Shell Option - [shopt](http://xgu.ru/wiki/shopt) - -s [huponexit](https://www.digitalocean.com/community/tutorials/how-to-use-bash-s-job-control-to-manage-foreground-and-background-processes)

```
â€˜sleepâ€™: Delay for a specified time
â€˜sleepâ€™ pauses for an amount of time specified by the sum of the values
     sleep NUMBER[smhd].

```

```sh
#!/bin/bash
 
echo "Waiting for 0.05 minutes..."
sleep 0.05m
echo "Task Completed"
```
In the following script, â€˜mâ€˜ is used as the suffix with sleep command. Here, the time value is 0.05 minutes. After waiting 0.05 minutes, â€œTask completedâ€ message will be printed.
Similar as "wait"
```
 wait [-n] [n ...]
              line are waited for.  If n is not given, all currently active  child  processes  are  waited
              for, and the return status is zero.  If the -n option is supplied, wait waits for any job to
              or job waited for.
       wait â€” await process completion
       wait [pid...]
```

***

##### Part2
1. Check the implementability of the most frequently used OPENSSH commands in the MS Windows operating system. (Description of the expected result of the commands + screenshots: command â€“ result should be presented)

```ssh``` -(SSH client) is a program for logging into a remote machine and for executing commands on a remote machine. It is intended to provide secure encrypted communications between two untrusted hosts over an insecure network. X11 connections, arbitrary TCP ports and UNIX-domain sockets can also be forwarded over the secure channel.
It's connects and logs into the specified destination, which may be specified as either [user@]hostname or a URI of the form ssh://[user@]hostname[:port]. The user must prove his/her identity to the remote machine using one of several methods (see below).

```ssh-keygen``` - OpenSSH authentication key utility which generates, manages and converts authentication keys for ssh(1)
```ssh-keysign``` -OpenSSH helper for host-based authentication. ssh-keysign is used by ssh(1) to access the local host keys and generate the digital signature required during host-based authentication.
```ssh-keysign``` is **disabled by default** and can only be enabled in the global client configuration file /etc/ssh/ssh_config by setting EnableSSHKeysign to â€œyesâ€.

```ssh-keyscan``` is a utility for gathering the public SSH host keys of a number of hosts. It was designed to aid in building and verifying ssh_known_hosts files, the format of which is documented in sshd(8). ssh-keyscan provides a minimal interface suitable for use by shell and perl scripts.
```sftp``` -OpenSSH secure file transfer similar to ftp(1), which performs all operations over an encrypted ssh(1) transport. The destination may be specified either as [user@]host[:path] or as a URI in the form sftp://[user@]host[:port][/path].
```scp```-OpenSSH secure files copy between hosts on a network.The source and target may be specified as a local pathname, a remote host with optional path in the form [user@]host:[path], or a URI in the form scp://[user@]host[:port][/path]. Local file names can be made explicit using absolute or relative pathnames to avoid scp treating file names containing â€˜:â€™ as host specifiers.


![Image](https://github.com/Twicer/DevOps_online_Dnipro_2020Q42021Q1/blob/master/m5/task5.3/screens/1.png)

![Image](https://github.com/Twicer/DevOps_online_Dnipro_2020Q42021Q1/blob/master/m5/task5.3/screens/2.png)

2. Implement basic SSH settings to increase the security of the client-server connection (at least
>My basic SSH setings to increse the security:

*Disabling their entry under the root
PermitRootLogin no
UsePAM no
> If you need u can use PAM

*Logging
SyslogFacility AUTH
SyslogFacility AUTHPRIV
LogLevel INFO

*Disable password login (recommended) and Use key based authentication
AuthorizedKeysFile     %h/.ssh/authorized_keys

*Disabling the response to the recognition of the type of authentication
ChallengeResponseAuthentication no
PasswordAuthentication no

*Reducing the number of login attempts
MaxAuthTries 3

*Reducing authorization time
LoginGraceTime 2

*Reducing timeout
ClientAliveInterval 600
ClientAliveCountMax 3

*Changing the port
Port2046

*Chnging version 2
Protocol 2

*Disable blank passwords

*Adding a banner with the script / warning
Banner /some/path


```sh
ALERT! You are entering a secured area! Your IP and login information
have been recorded. System administration has been notified.

This system is restricted to authorized access only. All activities on
this system are recorded and logged. Unauthorized access will be fully
investigated and reported to the appropriate law enforcement agencies
```
[.](https://www.ibm.com/developerworks/ru/library/au-sshlocks/index.html)

3. List the options for choosing keys for encryption in SSH. Implement 3 of them.
```ssh-keygen -t rsa -b 4096 -C "Alisa"```
```ssh-keygen -t ed25519 -C "Bob"```
```ssh-keygen -t ed25519 -b 4096 -a 250 -C "Bob"```
```ssh-keygen -t ecdsa -C "Carl"```

```sh
openssl genrsa -aes256 -out private.key 4096
ssh-keygen -y -f private.key > public.key.pub
```

* ``` ssh -c aes256-cbc user@host```

4. Implement port forwarding for the SSH client from the host machine to the guest Linux virtual machine behind NAT[.](https://www.ssh.com/ssh/tunneling/example)

Remote forwarding - This allows anyone on the remote server to connect to TCP port 8080 on the remote server. The connection will then be tunneled back to the client host, and the client then makes a TCP connection to port 80 on localhost. Any other host name or IP address could be used instead of localhost to specify the host to connect to.
```ssh -R 8080:localhost:80 public.example.com```

opens a local port. Everything that you send to that port is put through the ssh connection and leaves through the server.
This example opens a connection to the google.com jump server, and forwards any connection to port 80 on the local machine to port 80 on 192.168.0.1
```ssh -L 4444:google.com:80 192.168.0.1```

```ssh -D``` opens a local port, but it doesn't have a specific endpoint like with -L. Instead, it pretends to be a SOCKS proxy.
Following command opens access to an internal Postgres database at port 1111 and an internal SSH port at port 2222
```ssh -R 2222:sector7.example.com:22 -R 1111:postgresexample.com:1111 gsp.mydomainname.com```

**  > FOR VirtualBox 

![Image](https://github.com/Twicer/DevOps_online_Dnipro_2020Q42021Q1/blob/master/m5/task5.3/screens/3.jpg)

```iptables --append FORWARD --protocol tcp --src 10.0.2.2 --sport 22 --dst 0.0.0.0 --dport 2223```

5*. Intercept (capture) traffic (tcpdump, wireshark) while authorizing the remote client on the
server using ssh, telnet, rlogin. Analyze the result.

```tcpdump -i en01 -w dump.pcap 'telnet&&ssh&&telnet&&rlogin' ```

```tshark -w packets.pcap -f "telnet&&ssh&&rlogin"```

or parse

```tcpdump -r packetsdump.pcap 'telnet&&ssh&&rlogin' -w ssh,telnet,rlofin_packets.pcap```

telnet and rlogin aren't a secure protocols can be captured and decrypted[.](https://en.wikipedia.org/wiki/Berkeley_r-commands#rlogin)

© Oleksii Volchenko
=======
